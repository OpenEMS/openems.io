<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) -->
<title>SHAiButtonCoprVM (OpenEMS Javadoc)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: com.dalsemi.onewire.application.sha, class: SHAiButtonCoprVM">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li><a href="#field-summary">Field</a></li>
<li><a href="#constructor-summary">Constr</a></li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li><a href="#field-detail">Field</a></li>
<li><a href="#constructor-detail">Constr</a></li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field-detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">com.dalsemi.onewire.application.sha</a></div>
<h1 title="Class SHAiButtonCoprVM" class="title">Class SHAiButtonCoprVM</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance"><a href="SHAiButtonCopr.html" title="class in com.dalsemi.onewire.application.sha">com.dalsemi.onewire.application.sha.SHAiButtonCopr</a>
<div class="inheritance">com.dalsemi.onewire.application.sha.SHAiButtonCoprVM</div>
</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">SHAiButtonCoprVM</span>
<span class="extends-implements">extends <a href="SHAiButtonCopr.html" title="class in com.dalsemi.onewire.application.sha">SHAiButtonCopr</a></span></div>
<div class="block"><P>
 Class for simulating an instance of a SHA iButton Coprocessor involved in SHA
 Transactions. The Coprocessor is used for digitally signing transaction data
 as well as generating random challenges for users and verifying their
 response.
 </P>

 <p>
 With this class, no DS1963S SHA iButton is necessary for the coprocessor in
 SHA Transactions. The simulated Coprocessor iButton verifies signatures and
 signs data for User iButtons.
 </P>

 <p>
 This class makes use of several performance enhancements for TINI. For
 instance, most methods are <code>synchronized</code> to access instance
 variable byte arrays rather than creating new byte arrays every time a
 transaction is performed. This could hurt performance in multi-threaded
 applications, but the usefulness of having several threads contending to talk
 to a single iButton is questionable since the methods in
 <code>com.dalsemi.onewire.adapter.DSPortAdapter</code>
 <code>beginExclusive(boolean)</code> and <code>endExclusive()</code> should
 be used.
 </p></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="SHATransaction.html" title="class in com.dalsemi.onewire.application.sha"><code>SHATransaction</code></a></li>
<li><a href="SHAiButtonUser.html" title="class in com.dalsemi.onewire.application.sha"><code>SHAiButtonUser</code></a></li>
<li><a href="SHAiButtonCopr.html" title="class in com.dalsemi.onewire.application.sha"><code>SHAiButtonCopr</code></a></li>
</ul>
</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>protected byte[]</code></div>
<div class="col-second even-row-color"><code><a href="#address" class="member-name-link">address</a></code></div>
<div class="col-last even-row-color">
<div class="block">1-Wire Address for this simulated device</div>
</div>
<div class="col-first odd-row-color"><code>protected byte[][]</code></div>
<div class="col-second odd-row-color"><code><a href="#secretPage" class="member-name-link">secretPage</a></code></div>
<div class="col-last odd-row-color">
<div class="block">8 8-byte Secrets for this simulated SHAiButton</div>
</div>
</div>
<div class="inherited-list">
<h3 id="fields-inherited-from-class-com.dalsemi.onewire.application.sha.SHAiButtonCopr">Fields inherited from class&nbsp;com.dalsemi.onewire.application.sha.<a href="SHAiButtonCopr.html" title="class in com.dalsemi.onewire.application.sha">SHAiButtonCopr</a></h3>
<code><a href="SHAiButtonCopr.html#authPageNumber">authPageNumber</a>, <a href="SHAiButtonCopr.html#auxData">auxData</a>, <a href="SHAiButtonCopr.html#BIND_SECRET_FAILED">BIND_SECRET_FAILED</a>, <a href="SHAiButtonCopr.html#bindCode">bindCode</a>, <a href="SHAiButtonCopr.html#bindData">bindData</a>, <a href="SHAiButtonCopr.html#COPY_SCRATCHPAD_FAILED">COPY_SCRATCHPAD_FAILED</a>, <a href="SHAiButtonCopr.html#DS1961Scompatible">DS1961Scompatible</a>, <a href="SHAiButtonCopr.html#encCode">encCode</a>, <a href="SHAiButtonCopr.html#ERASE_SCRATCHPAD_FAILED">ERASE_SCRATCHPAD_FAILED</a>, <a href="SHAiButtonCopr.html#filename">filename</a>, <a href="SHAiButtonCopr.html#ibc">ibc</a>, <a href="SHAiButtonCopr.html#initialSignature">initialSignature</a>, <a href="SHAiButtonCopr.html#lastError">lastError</a>, <a href="SHAiButtonCopr.html#MATCH_SCRATCHPAD_FAILED">MATCH_SCRATCHPAD_FAILED</a>, <a href="SHAiButtonCopr.html#NO_ERROR">NO_ERROR</a>, <a href="SHAiButtonCopr.html#providerName">providerName</a>, <a href="SHAiButtonCopr.html#SHA_FUNCTION_FAILED">SHA_FUNCTION_FAILED</a>, <a href="SHAiButtonCopr.html#signingChallenge">signingChallenge</a>, <a href="SHAiButtonCopr.html#signPageNumber">signPageNumber</a>, <a href="SHAiButtonCopr.html#version">version</a>, <a href="SHAiButtonCopr.html#WRITE_DATA_PAGE_FAILED">WRITE_DATA_PAGE_FAILED</a>, <a href="SHAiButtonCopr.html#WRITE_SCRATCHPAD_FAILED">WRITE_SCRATCHPAD_FAILED</a>, <a href="SHAiButtonCopr.html#wspcPageNumber">wspcPageNumber</a></code></div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(byte%5B%5D,int,int,int,int,int,byte,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D)" class="member-name-link">SHAiButtonCoprVM</a><wbr>(byte[]&nbsp;RomID,
 int&nbsp;l_signPageNumber,
 int&nbsp;l_authPageNumber,
 int&nbsp;l_wspcPageNumber,
 int&nbsp;l_version,
 int&nbsp;l_encCode,
 byte&nbsp;l_serviceFileExt,
 byte[]&nbsp;l_serviceFilename,
 byte[]&nbsp;l_providerName,
 byte[]&nbsp;l_bindData,
 byte[]&nbsp;l_bindCode,
 byte[]&nbsp;l_auxData,
 byte[]&nbsp;l_initialSignature,
 byte[]&nbsp;l_signingChlg,
 byte[]&nbsp;l_signingSecret,
 byte[]&nbsp;l_authSecret)</code></div>
<div class="col-last even-row-color">
<div class="block">
 Sets up this simulated coprocessor based on the provided parameters.</div>
</div>
<div class="col-constructor-name odd-row-color"><code><a href="#%3Cinit%3E(com.dalsemi.onewire.container.OneWireContainer18,java.lang.String,byte%5B%5D,byte%5B%5D)" class="member-name-link">SHAiButtonCoprVM</a><wbr>(<a href="../../container/OneWireContainer18.html" title="class in com.dalsemi.onewire.container">OneWireContainer18</a>&nbsp;owc,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename,
 byte[]&nbsp;sign_secret,
 byte[]&nbsp;auth_secret)</code></div>
<div class="col-last odd-row-color">
<div class="block">
 Simulates a specific DS1963S coprocessor device.</div>
</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(com.dalsemi.onewire.container.OneWireContainer,java.lang.String)" class="member-name-link">SHAiButtonCoprVM</a><wbr>(<a href="../../container/OneWireContainer.html" title="class in com.dalsemi.onewire.container">OneWireContainer</a>&nbsp;owc,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename)</code></div>
<div class="col-last even-row-color">
<div class="block">
 Loads a simulated DS1963S coprocessor device from any 1-Wire memory device
 supported by the 1-Wire File I/O API.</div>
</div>
<div class="col-constructor-name odd-row-color"><code><a href="#%3Cinit%3E(com.dalsemi.onewire.container.OneWireContainer,java.lang.String,byte%5B%5D,byte%5B%5D)" class="member-name-link">SHAiButtonCoprVM</a><wbr>(<a href="../../container/OneWireContainer.html" title="class in com.dalsemi.onewire.container">OneWireContainer</a>&nbsp;owc,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename,
 byte[]&nbsp;sign_secret,
 byte[]&nbsp;auth_secret)</code></div>
<div class="col-last odd-row-color">
<div class="block">
 Loads a simulated DS1963S coprocessor device from any 1-Wire memory device
 supported by the 1-Wire File I/O API.</div>
</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(java.lang.String)" class="member-name-link">SHAiButtonCoprVM</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename)</code></div>
<div class="col-last even-row-color">
<div class="block">
 Loads a simulated DS1963S coprocessor device from disk.</div>
</div>
<div class="col-constructor-name odd-row-color"><code><a href="#%3Cinit%3E(java.lang.String,byte%5B%5D,byte%5B%5D)" class="member-name-link">SHAiButtonCoprVM</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename,
 byte[]&nbsp;sign_secret,
 byte[]&nbsp;auth_secret)</code></div>
<div class="col-last odd-row-color">
<div class="block">
 Loads a simulated DS1963S coprocessor device from disk.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#bindSecretToiButton(int,byte%5B%5D,byte%5B%5D,int)" class="member-name-link">bindSecretToiButton</a><wbr>(int&nbsp;pageNum,
 byte[]&nbsp;bindData,
 byte[]&nbsp;bindCode,
 int&nbsp;secretNum)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">
 Binds an installed secret to this virtual DS1963S by using well-known binding
 data and this DS1963S's (unique?) address.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#createDataSignature(byte%5B%5D,byte%5B%5D,byte%5B%5D,int)" class="member-name-link">createDataSignature</a><wbr>(byte[]&nbsp;accountData,
 byte[]&nbsp;signScratchpad,
 byte[]&nbsp;mac_buffer,
 int&nbsp;macStart)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">
 Given a 32-byte array for page data and a 32-byte array for scratchpad
 content, this function will create a 20-byte signature for the data based on
 SHA-1.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#createDataSignatureAuth(byte%5B%5D,byte%5B%5D,byte%5B%5D,int,byte%5B%5D)" class="member-name-link">createDataSignatureAuth</a><wbr>(byte[]&nbsp;accountData,
 byte[]&nbsp;signScratchpad,
 byte[]&nbsp;mac_buffer,
 int&nbsp;macStart,
 byte[]&nbsp;fullBindCode)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">
 Creates a data signature, but instead of using the signing secret, it uses
 the authentication secret, bound for a particular button.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#generateChallenge(int,byte%5B%5D,int)" class="member-name-link">generateChallenge</a><wbr>(int&nbsp;offset,
 byte[]&nbsp;ch,
 int&nbsp;start)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">
 Generates a 3 byte random challenge in the iButton, sufficient to be used as
 a challenge to be answered by a User iButton.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#installMasterSecret(int,byte%5B%5D,int)" class="member-name-link">installMasterSecret</a><wbr>(int&nbsp;pageNum,
 byte[]&nbsp;secret,
 int&nbsp;secretNum)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">
 Installs a secret on this virtual DS1963S.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#load(com.dalsemi.onewire.container.OneWireContainer18,java.lang.String)" class="member-name-link">load</a><wbr>(<a href="../../container/OneWireContainer18.html" title="class in com.dalsemi.onewire.container">OneWireContainer18</a>&nbsp;owc,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">
 Loads coprocessor configuration information from a standard TMEX service file
 on a DS1963S.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#load(com.dalsemi.onewire.container.OneWireContainer,java.lang.String)" class="member-name-link">load</a><wbr>(<a href="../../container/OneWireContainer.html" title="class in com.dalsemi.onewire.container">OneWireContainer</a>&nbsp;owc,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">
 Loads coprocessor configuration information from an (almost) standard service
 TMEX file on 1-Wire memory device.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#load(java.lang.String)" class="member-name-link">load</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">
 Loads coprocessor configuration information from an (almost) standard service
 file on hard drive.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#save(com.dalsemi.onewire.container.OneWireContainer,java.lang.String,boolean)" class="member-name-link">save</a><wbr>(<a href="../../container/OneWireContainer.html" title="class in com.dalsemi.onewire.container">OneWireContainer</a>&nbsp;owc,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename,
 boolean&nbsp;saveSecretData)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">
 Saves simulated coprocessor configuration info to an (almost) standard-format
 to a 1-Wire Memory Device's TMEX file.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#save(java.lang.String,boolean)" class="member-name-link">save</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename,
 boolean&nbsp;saveSecretData)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">
 Saves simulated coprocessor configuration info to an (almost) standard-format
 to a hard drive file.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#toString()" class="member-name-link">toString</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns a string representing the 1-Wire address of this SHAiButton.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#verifyAuthentication(byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte)" class="member-name-link">verifyAuthentication</a><wbr>(byte[]&nbsp;fullBindCode,
 byte[]&nbsp;pageData,
 byte[]&nbsp;scratchpad,
 byte[]&nbsp;verify_mac,
 byte&nbsp;authCmd)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">
 Determines if a <code>SHAiButtonUser</code> belongs to the system defined by
 this Coprocessor iButton.See the usage example in this class for initializing
 a Coprocessor iButton.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#verifySignature(byte%5B%5D,byte%5B%5D,byte%5B%5D)" class="member-name-link">verifySignature</a><wbr>(byte[]&nbsp;pageData,
 byte[]&nbsp;scratchpad,
 byte[]&nbsp;verify_mac)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">
 Verifies a User iButton's signed data on this Coprocessor iButton.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-com.dalsemi.onewire.application.sha.SHAiButtonCopr">Methods inherited from class&nbsp;com.dalsemi.onewire.application.sha.<a href="SHAiButtonCopr.html" title="class in com.dalsemi.onewire.application.sha">SHAiButtonCopr</a></h3>
<code><a href="SHAiButtonCopr.html#fromStream(java.io.InputStream)">fromStream</a>, <a href="SHAiButtonCopr.html#getAddress()">getAddress</a>, <a href="SHAiButtonCopr.html#getAddress(byte%5B%5D,int)">getAddress</a>, <a href="SHAiButtonCopr.html#getAddress(byte%5B%5D,int,int)">getAddress</a>, <a href="SHAiButtonCopr.html#getAuthenticationPageNumber()">getAuthenticationPageNumber</a>, <a href="SHAiButtonCopr.html#getAuxilliaryData()">getAuxilliaryData</a>, <a href="SHAiButtonCopr.html#getBindCode()">getBindCode</a>, <a href="SHAiButtonCopr.html#getBindCode(byte%5B%5D,int)">getBindCode</a>, <a href="SHAiButtonCopr.html#getBindData()">getBindData</a>, <a href="SHAiButtonCopr.html#getBindData(byte%5B%5D,int)">getBindData</a>, <a href="SHAiButtonCopr.html#getEncryptionCode()">getEncryptionCode</a>, <a href="SHAiButtonCopr.html#getFilename(byte%5B%5D,int)">getFilename</a>, <a href="SHAiButtonCopr.html#getFilenameExt()">getFilenameExt</a>, <a href="SHAiButtonCopr.html#getInitialSignature()">getInitialSignature</a>, <a href="SHAiButtonCopr.html#getInitialSignature(byte%5B%5D,int)">getInitialSignature</a>, <a href="SHAiButtonCopr.html#getLastError()">getLastError</a>, <a href="SHAiButtonCopr.html#getProviderName()">getProviderName</a>, <a href="SHAiButtonCopr.html#getSigningChallenge()">getSigningChallenge</a>, <a href="SHAiButtonCopr.html#getSigningChallenge(byte%5B%5D,int)">getSigningChallenge</a>, <a href="SHAiButtonCopr.html#getSigningPageNumber()">getSigningPageNumber</a>, <a href="SHAiButtonCopr.html#getVersion()">getVersion</a>, <a href="SHAiButtonCopr.html#getWorkspacePageNumber()">getWorkspacePageNumber</a>, <a href="SHAiButtonCopr.html#isDS1961Scompatible()">isDS1961Scompatible</a>, <a href="SHAiButtonCopr.html#reformatFor1961S(byte%5B%5D)">reformatFor1961S</a>, <a href="SHAiButtonCopr.html#toStream(java.io.OutputStream)">toStream</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="secretPage">
<h3>secretPage</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">byte[][]</span>&nbsp;<span class="element-name">secretPage</span></div>
<div class="block">8 8-byte Secrets for this simulated SHAiButton</div>
</section>
</li>
<li>
<section class="detail" id="address">
<h3>address</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">address</span></div>
<div class="block">1-Wire Address for this simulated device</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(byte[],int,int,int,int,int,byte,byte[],byte[],byte[],byte[],byte[],byte[],byte[],byte[],byte[])">
<h3>SHAiButtonCoprVM</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">SHAiButtonCoprVM</span><wbr><span class="parameters">(byte[]&nbsp;RomID,
 int&nbsp;l_signPageNumber,
 int&nbsp;l_authPageNumber,
 int&nbsp;l_wspcPageNumber,
 int&nbsp;l_version,
 int&nbsp;l_encCode,
 byte&nbsp;l_serviceFileExt,
 byte[]&nbsp;l_serviceFilename,
 byte[]&nbsp;l_providerName,
 byte[]&nbsp;l_bindData,
 byte[]&nbsp;l_bindCode,
 byte[]&nbsp;l_auxData,
 byte[]&nbsp;l_initialSignature,
 byte[]&nbsp;l_signingChlg,
 byte[]&nbsp;l_signingSecret,
 byte[]&nbsp;l_authSecret)</span>
                 throws <span class="exceptions"><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a>,
<a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></span></div>
<div class="block"><P>
 Sets up this simulated coprocessor based on the provided parameters. Then,
 the system secret and authentication secret are installed on the simulated
 coprocessor iButton.
 </P>

 <P>
 For the proper format of the coprocessor data file, see the document entitled
 "Implementing Secured D-Identification and E-Payment Applications using SHA
 iButtons". For the format of TMEX file structures, see Application Note 114.
 </P></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>RomID</code> - The address for the simulated coprocessor.</dd>
<dd><code>l_signPageNumber</code> - page number used for signing user account data.
                           (Should be page 8, but page 0 is acceptable if you
                           don't need the TMEX directory structure)</dd>
<dd><code>l_authPageNumber</code> - page number used for recreating user secret.</dd>
<dd><code>l_wspcPageNumber</code> - page number used for storing user secret and
                           recreating authentication MAC.</dd>
<dd><code>l_version</code> - version of the service provided by this
                           coprocessor.</dd>
<dd><code>l_encCode</code> - refers to a type of encryption used for user
                           account data stored on user buttons.</dd>
<dd><code>l_serviceFileExt</code> - the file extension used for the service file. (An
                           extension of decimal 102 is reserved for Money
                           files).</dd>
<dd><code>l_serviceFilename</code> - the 4-byte name of the user's account data file.</dd>
<dd><code>l_providerName</code> - the name of the provider of this service</dd>
<dd><code>l_bindData</code> - the binding data used to finalize secret
                           installation on user buttons.</dd>
<dd><code>l_bindCode</code> - the binding code used to finalize secret
                           installation on user buttons.</dd>
<dd><code>l_auxData</code> - any auxiliary or miscellaneous data to be stored on
                           the coprocessor.</dd>
<dd><code>l_initialSignature</code> - the 20-byte initial MAC placed in user account data
                           before generating actual MAC.</dd>
<dd><code>l_signingChlg</code> - the 3-byte challenge used for signing user account
                           data.</dd>
<dd><code>l_signingSecret</code> - the system signing secret used by the service being
                           installed on this coprocessor.</dd>
<dd><code>l_authSecret</code> - the system authentication secret used by the
                           service being installed on this coprocessor.</dd>
<dt>Throws:</dt>
<dd><code><a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></code> - on a 1-Wire communication error such as reading an
                            incorrect CRC from a 1-Wire device. This could be
                            caused by a physical interruption in the 1-Wire
                            Network due to shorts or a newly arriving 1-Wire
                            device issuing a 'presence pulse'.</dd>
<dd><code><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a></code> - on a communication or setup error with the 1-Wire
                            adapter</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#%3Cinit%3E(java.lang.String)"><code>SHAiButtonCoprVM(String)</code></a></li>
<li><a href="#%3Cinit%3E(java.lang.String,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(String,byte[],byte[])</code></a></li>
<li><a href="#%3Cinit%3E(com.dalsemi.onewire.container.OneWireContainer,java.lang.String)"><code>SHAiButtonCoprVM(OneWireContainer,String)</code></a></li>
<li><a href="#%3Cinit%3E(com.dalsemi.onewire.container.OneWireContainer,java.lang.String,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(OneWireContainer,String,byte[],byte[])</code></a></li>
<li><a href="#%3Cinit%3E(com.dalsemi.onewire.container.OneWireContainer18,java.lang.String,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(OneWireContainer18,String,byte[],byte[])</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="&lt;init&gt;(java.lang.String)">
<h3>SHAiButtonCoprVM</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">SHAiButtonCoprVM</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename)</span>
                 throws <span class="exceptions"><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a>,
<a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></span></div>
<div class="block"><p>
 Loads a simulated DS1963S coprocessor device from disk. The given file name
 is loaded to get all the parameters of the coprocessor. It is assumed that
 the secrets were stored in the file when the simulated coprocessor's data was
 saved to disk.
 </p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>filename</code> - The filename of the simulated coprocessor's data file
                 ("shaCopr.dat")</dd>
<dt>Throws:</dt>
<dd><code><a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></code> - on a 1-Wire communication error such as reading an
                            incorrect CRC from a 1-Wire device. This could be
                            caused by a physical interruption in the 1-Wire
                            Network due to shorts or a newly arriving 1-Wire
                            device issuing a 'presence pulse'.</dd>
<dd><code><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a></code> - on a communication or setup error with the 1-Wire
                            adapter</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#%3Cinit%3E(java.lang.String,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(String,byte[],byte[])</code></a></li>
<li><a href="#%3Cinit%3E(com.dalsemi.onewire.container.OneWireContainer,java.lang.String)"><code>SHAiButtonCoprVM(OneWireContainer,String)</code></a></li>
<li><a href="#%3Cinit%3E(com.dalsemi.onewire.container.OneWireContainer,java.lang.String,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(OneWireContainer,String,byte[],byte[])</code></a></li>
<li><a href="#%3Cinit%3E(com.dalsemi.onewire.container.OneWireContainer18,java.lang.String,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(OneWireContainer18,String,byte[],byte[])</code></a></li>
<li><a href="#%3Cinit%3E(byte%5B%5D,int,int,int,int,int,byte,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(byte[],int,int,int,int,int,byte,byte[],byte[],byte[],byte[],byte[],byte[],byte[],byte[],byte[])</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="&lt;init&gt;(java.lang.String,byte[],byte[])">
<h3>SHAiButtonCoprVM</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">SHAiButtonCoprVM</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename,
 byte[]&nbsp;sign_secret,
 byte[]&nbsp;auth_secret)</span>
                 throws <span class="exceptions"><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a>,
<a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></span></div>
<div class="block"><p>
 Loads a simulated DS1963S coprocessor device from disk. The given file name
 is loaded to get all the parameters of the coprocessor. After it is loaded,
 the given secrets are installed.
 </p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>filename</code> - The filename of the simulated coprocessor's data file
                    ("shaCopr.dat")</dd>
<dd><code>sign_secret</code> - The system data signing secret.</dd>
<dd><code>auth_secret</code> - The system device authentication secret.</dd>
<dt>Throws:</dt>
<dd><code><a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></code> - on a 1-Wire communication error such as reading an
                            incorrect CRC from a 1-Wire device. This could be
                            caused by a physical interruption in the 1-Wire
                            Network due to shorts or a newly arriving 1-Wire
                            device issuing a 'presence pulse'.</dd>
<dd><code><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a></code> - on a communication or setup error with the 1-Wire
                            adapter</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#%3Cinit%3E(java.lang.String)"><code>SHAiButtonCoprVM(String)</code></a></li>
<li><a href="#%3Cinit%3E(com.dalsemi.onewire.container.OneWireContainer,java.lang.String)"><code>SHAiButtonCoprVM(OneWireContainer,String)</code></a></li>
<li><a href="#%3Cinit%3E(com.dalsemi.onewire.container.OneWireContainer,java.lang.String,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(OneWireContainer,String,byte[],byte[])</code></a></li>
<li><a href="#%3Cinit%3E(com.dalsemi.onewire.container.OneWireContainer18,java.lang.String,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(OneWireContainer18,String,byte[],byte[])</code></a></li>
<li><a href="#%3Cinit%3E(byte%5B%5D,int,int,int,int,int,byte,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(byte[],int,int,int,int,int,byte,byte[],byte[],byte[],byte[],byte[],byte[],byte[],byte[],byte[])</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="&lt;init&gt;(com.dalsemi.onewire.container.OneWireContainer,java.lang.String)">
<h3>SHAiButtonCoprVM</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">SHAiButtonCoprVM</span><wbr><span class="parameters">(<a href="../../container/OneWireContainer.html" title="class in com.dalsemi.onewire.container">OneWireContainer</a>&nbsp;owc,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename)</span>
                 throws <span class="exceptions"><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a>,
<a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></span></div>
<div class="block"><p>
 Loads a simulated DS1963S coprocessor device from any 1-Wire memory device
 supported by the 1-Wire File I/O API. The given file name is loaded to get
 all the parameters of the coprocessor. It is assumed that the secrets were
 stored in the file when the simulated coprocessor's data was saved to disk.
 </p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>owc</code> - 1-Wire memory device with valid TMEX file system</dd>
<dd><code>filename</code> - The filename of the simulated coprocessor's data file
                 ("shaCopr.dat")</dd>
<dt>Throws:</dt>
<dd><code><a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></code> - on a 1-Wire communication error such as reading an
                            incorrect CRC from a 1-Wire device. This could be
                            caused by a physical interruption in the 1-Wire
                            Network due to shorts or a newly arriving 1-Wire
                            device issuing a 'presence pulse'.</dd>
<dd><code><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a></code> - on a communication or setup error with the 1-Wire
                            adapter</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#%3Cinit%3E(java.lang.String)"><code>SHAiButtonCoprVM(String)</code></a></li>
<li><a href="#%3Cinit%3E(java.lang.String,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(String,byte[],byte[])</code></a></li>
<li><a href="#%3Cinit%3E(com.dalsemi.onewire.container.OneWireContainer,java.lang.String,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(OneWireContainer,String,byte[],byte[])</code></a></li>
<li><a href="#%3Cinit%3E(com.dalsemi.onewire.container.OneWireContainer18,java.lang.String,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(OneWireContainer18,String,byte[],byte[])</code></a></li>
<li><a href="#%3Cinit%3E(byte%5B%5D,int,int,int,int,int,byte,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(byte[],int,int,int,int,int,byte,byte[],byte[],byte[],byte[],byte[],byte[],byte[],byte[],byte[])</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="&lt;init&gt;(com.dalsemi.onewire.container.OneWireContainer,java.lang.String,byte[],byte[])">
<h3>SHAiButtonCoprVM</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">SHAiButtonCoprVM</span><wbr><span class="parameters">(<a href="../../container/OneWireContainer.html" title="class in com.dalsemi.onewire.container">OneWireContainer</a>&nbsp;owc,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename,
 byte[]&nbsp;sign_secret,
 byte[]&nbsp;auth_secret)</span>
                 throws <span class="exceptions"><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a>,
<a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></span></div>
<div class="block"><p>
 Loads a simulated DS1963S coprocessor device from any 1-Wire memory device
 supported by the 1-Wire File I/O API. The given file name is loaded to get
 all the parameters of the coprocessor. After it is loaded, the given secrets
 are installed.
 </p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>owc</code> - 1-Wire memory device with valid TMEX file system</dd>
<dd><code>filename</code> - The filename of the simulated coprocessor's data file
                    ("shaCopr.dat")</dd>
<dd><code>sign_secret</code> - The system data signing secret.</dd>
<dd><code>auth_secret</code> - The system device authentication secret.</dd>
<dt>Throws:</dt>
<dd><code><a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></code> - on a 1-Wire communication error such as reading an
                            incorrect CRC from a 1-Wire device. This could be
                            caused by a physical interruption in the 1-Wire
                            Network due to shorts or a newly arriving 1-Wire
                            device issuing a 'presence pulse'.</dd>
<dd><code><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a></code> - on a communication or setup error with the 1-Wire
                            adapter</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#%3Cinit%3E(java.lang.String)"><code>SHAiButtonCoprVM(String)</code></a></li>
<li><a href="#%3Cinit%3E(java.lang.String,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(String,byte[],byte[])</code></a></li>
<li><a href="#%3Cinit%3E(com.dalsemi.onewire.container.OneWireContainer,java.lang.String)"><code>SHAiButtonCoprVM(OneWireContainer,String)</code></a></li>
<li><a href="#%3Cinit%3E(com.dalsemi.onewire.container.OneWireContainer18,java.lang.String,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(OneWireContainer18,String,byte[],byte[])</code></a></li>
<li><a href="#%3Cinit%3E(byte%5B%5D,int,int,int,int,int,byte,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(byte[],int,int,int,int,int,byte,byte[],byte[],byte[],byte[],byte[],byte[],byte[],byte[],byte[])</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="&lt;init&gt;(com.dalsemi.onewire.container.OneWireContainer18,java.lang.String,byte[],byte[])">
<h3>SHAiButtonCoprVM</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">SHAiButtonCoprVM</span><wbr><span class="parameters">(<a href="../../container/OneWireContainer18.html" title="class in com.dalsemi.onewire.container">OneWireContainer18</a>&nbsp;owc,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename,
 byte[]&nbsp;sign_secret,
 byte[]&nbsp;auth_secret)</span>
                 throws <span class="exceptions"><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a>,
<a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></span></div>
<div class="block"><p>
 Simulates a specific DS1963S coprocessor device. First, the given TMEX file
 name is loaded of the container to get all the parameters of the coprocessor.
 Then (since secrets are not readable off the iButton, they must be provided)
 the secrets are installed on the virtual coprocessor.
 </p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>owc</code> - The coprocessor button this VM will simulate.</dd>
<dd><code>filename</code> - The TMEX filename of the coprocessor service file
                    ("COPR.0")</dd>
<dd><code>sign_secret</code> - The system data signing secret.</dd>
<dd><code>auth_secret</code> - The system device authentication secret.</dd>
<dt>Throws:</dt>
<dd><code><a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></code> - on a 1-Wire communication error such as reading an
                            incorrect CRC from a 1-Wire device. This could be
                            caused by a physical interruption in the 1-Wire
                            Network due to shorts or a newly arriving 1-Wire
                            device issuing a 'presence pulse'.</dd>
<dd><code><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a></code> - on a communication or setup error with the 1-Wire
                            adapter</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#%3Cinit%3E(java.lang.String)"><code>SHAiButtonCoprVM(String)</code></a></li>
<li><a href="#%3Cinit%3E(java.lang.String,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(String,byte[],byte[])</code></a></li>
<li><a href="#%3Cinit%3E(com.dalsemi.onewire.container.OneWireContainer,java.lang.String)"><code>SHAiButtonCoprVM(OneWireContainer,String)</code></a></li>
<li><a href="#%3Cinit%3E(com.dalsemi.onewire.container.OneWireContainer,java.lang.String,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(OneWireContainer,String,byte[],byte[])</code></a></li>
<li><a href="#%3Cinit%3E(byte%5B%5D,int,int,int,int,int,byte,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D)"><code>SHAiButtonCoprVM(byte[],int,int,int,int,int,byte,byte[],byte[],byte[],byte[],byte[],byte[],byte[],byte[],byte[])</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="save(java.lang.String,boolean)">
<h3>save</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">save</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename,
 boolean&nbsp;saveSecretData)</span>
             throws <span class="exceptions"><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a>,
<a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></span></div>
<div class="block"><p>
 Saves simulated coprocessor configuration info to an (almost) standard-format
 to a hard drive file.
 </p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>filename</code> - The filename of the simulated coprocessor's data file
                       ("shaCopr.dat")</dd>
<dd><code>saveSecretData</code> - If <code>true</true>, the raw secret information
        is also written to the file

 &#64;throws OneWireIOException on a 1-Wire communication error such as
         reading an incorrect CRC from a 1-Wire device.  This could be
         caused by a physical interruption in the 1-Wire Network due to
         shorts or a newly arriving 1-Wire device issuing a 'presence pulse'.
 &#64;throws OneWireException on a communication or setup error with the 1-Wire
         adapter

 &#64;return <code>true</code> if the info was successfully saved</dd>
<dt>Throws:</dt>
<dd><code><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a></code></dd>
<dd><code><a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="save(com.dalsemi.onewire.container.OneWireContainer,java.lang.String,boolean)">
<h3>save</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">save</span><wbr><span class="parameters">(<a href="../../container/OneWireContainer.html" title="class in com.dalsemi.onewire.container">OneWireContainer</a>&nbsp;owc,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename,
 boolean&nbsp;saveSecretData)</span>
             throws <span class="exceptions"><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a>,
<a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></span></div>
<div class="block"><p>
 Saves simulated coprocessor configuration info to an (almost) standard-format
 to a 1-Wire Memory Device's TMEX file.
 </p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>owc</code> - 1-Wire Memory Device with valid TMEX file structure.</dd>
<dd><code>filename</code> - The TMEX filename of the simulated coprocessor's data
                       file ("COPR.2")</dd>
<dd><code>saveSecretData</code> - If <code>true</true>, the raw secret information
        is also written to the file.

 &#64;throws OneWireIOException on a 1-Wire communication error such as
         reading an incorrect CRC from a 1-Wire device.  This could be
         caused by a physical interruption in the 1-Wire Network due to
         shorts or a newly arriving 1-Wire device issuing a 'presence pulse'.
 &#64;throws OneWireException on a communication or setup error with the 1-Wire
         adapter

 &#64;return <code>true</code> if the info was successfully saved</dd>
<dt>Throws:</dt>
<dd><code><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a></code></dd>
<dd><code><a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="load(java.lang.String)">
<h3>load</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">load</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename)</span></div>
<div class="block"><p>
 Loads coprocessor configuration information from an (almost) standard service
 file on hard drive. If secret information was saved, this routine
 automatically loads it.
 </P></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>filename</code> - The filename of the simulated coprocessor's data file
                 ("shaCopr.dat")</dd>
<dt>Returns:</dt>
<dd><code>true</code> if the info was successfully loaded</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="load(com.dalsemi.onewire.container.OneWireContainer,java.lang.String)">
<h3>load</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">load</span><wbr><span class="parameters">(<a href="../../container/OneWireContainer.html" title="class in com.dalsemi.onewire.container">OneWireContainer</a>&nbsp;owc,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename)</span></div>
<div class="block"><p>
 Loads coprocessor configuration information from an (almost) standard service
 TMEX file on 1-Wire memory device. If secret information was saved, this
 routine automatically loads it.
 </P></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>owc</code> - 1-Wire memory device with valid TMEX file structure</dd>
<dd><code>filename</code> - The TMEX filename of the simulated coprocessor's data file
                 ("COPR.2")</dd>
<dt>Returns:</dt>
<dd><code>true</code> if the info was successfully loaded</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="load(com.dalsemi.onewire.container.OneWireContainer18,java.lang.String)">
<h3>load</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">load</span><wbr><span class="parameters">(<a href="../../container/OneWireContainer18.html" title="class in com.dalsemi.onewire.container">OneWireContainer18</a>&nbsp;owc,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;filename)</span></div>
<div class="block"><p>
 Loads coprocessor configuration information from a standard TMEX service file
 on a DS1963S.
 </P></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>owc</code> - DS1963S set up as a valid coprocessor</dd>
<dd><code>filename</code> - The TMEX filename of the coprocessor's data file ("COPR.0")</dd>
<dt>Returns:</dt>
<dd><code>true</code> if the info was successfully loaded</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="createDataSignature(byte[],byte[],byte[],int)">
<h3>createDataSignature</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">createDataSignature</span><wbr><span class="parameters">(byte[]&nbsp;accountData,
 byte[]&nbsp;signScratchpad,
 byte[]&nbsp;mac_buffer,
 int&nbsp;macStart)</span>
                            throws <span class="exceptions"><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a>,
<a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></span></div>
<div class="block"><P>
 Given a 32-byte array for page data and a 32-byte array for scratchpad
 content, this function will create a 20-byte signature for the data based on
 SHA-1. The format of the calculation of the data signature is as follows:
 First 4-bytes of signing secret, 32-bytes of accountData, 12 bytes of
 scratchpad data starting at index 8, last 4-bytes of signing secret, 3 bytes
 of scratchpad data starting at index 20, and the rest is padding as specified
 for standard SHA-1. This is all laid out, in detail, in the DS1963S data
 sheet.
 </P>

 <P>
 The resulting 20-byte signature is copied into <code>mac_buffer</code>
 starting at <code>macStart</code>. If you're updating a signature that
 already exists in the accountData array, it is acceptable to call the method
 like so: <code><pre>
   copr.createDataSignature(accountData, spad, accountData, 8);
 </pre></code> assuming that the signature starts at index 8 of the
 accountData array.
 </p></div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="SHAiButtonCopr.html#createDataSignature(byte%5B%5D,byte%5B%5D,byte%5B%5D,int)">createDataSignature</a></code>&nbsp;in class&nbsp;<code><a href="SHAiButtonCopr.html" title="class in com.dalsemi.onewire.application.sha">SHAiButtonCopr</a></code></dd>
<dt>Parameters:</dt>
<dd><code>accountData</code> - the 32-byte data page for which the signature is
                       generated.</dd>
<dd><code>signScratchpad</code> - the 32-byte scratchpad contents for which the signature
                       is generated. This will contain parameters such as the
                       user's write cycle counter for the page, the user's
                       1-wire address, and the page number where account data
                       is stored.</dd>
<dd><code>mac_buffer</code> - used to return the 20-byte signature generated by
                       signing the page using the coprocessor's system signing
                       secret.</dd>
<dd><code>macStart</code> - the offset into mac_buffer where copying should start.</dd>
<dt>Returns:</dt>
<dd><code>true</code> if successful, <code>false</code> if an error
         occurred (use <code>getLastError()</code> for more information on the
         type of error)</dd>
<dt>Throws:</dt>
<dd><code><a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></code> - on a 1-Wire communication error such as reading an
                            incorrect CRC from a 1-Wire device. This could be
                            caused by a physical interruption in the 1-Wire
                            Network due to shorts or a newly arriving 1-Wire
                            device issuing a 'presence pulse'.</dd>
<dd><code><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a></code> - on a communication or setup error with the 1-Wire
                            adapter</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="../../container/OneWireContainer18.html#SHAFunction(byte,int)"><code>OneWireContainer18.SHAFunction(byte,int)</code></a></li>
<li><a href="SHAiButtonCopr.html#getLastError()"><code>SHAiButtonCopr.getLastError()</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="generateChallenge(int,byte[],int)">
<h3>generateChallenge</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">generateChallenge</span><wbr><span class="parameters">(int&nbsp;offset,
 byte[]&nbsp;ch,
 int&nbsp;start)</span>
                          throws <span class="exceptions"><a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a>,
<a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a></span></div>
<div class="block"><p>
 Generates a 3 byte random challenge in the iButton, sufficient to be used as
 a challenge to be answered by a User iButton. The user answers the challenge
 with an authenticated read of it's account data.
 </p>

 <p>
 The DS1963S will generate 20 bytes of pseudo random data, though only 3 bytes
 are needed for the challenge. Programs can add more 'randomness' by selecting
 different bytes from the 20 bytes of random data using the
 <code>offset</code> parameter.
 </p>

 <p>
 The random number generator is actually the DS1963S's SHA engine, which
 requires page data to compute a hash. Select a page number with the
 <code>page_number</code> parameter.
 </p></div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="SHAiButtonCopr.html#generateChallenge(int,byte%5B%5D,int)">generateChallenge</a></code>&nbsp;in class&nbsp;<code><a href="SHAiButtonCopr.html" title="class in com.dalsemi.onewire.application.sha">SHAiButtonCopr</a></code></dd>
<dt>Parameters:</dt>
<dd><code>offset</code> - offset into the 20 random bytes to draw random data from (must
               be in range 0-16)</dd>
<dd><code>ch</code> - buffer for the challenge to be returned (must be of length 3 or
               more)</dd>
<dd><code>start</code> - the starting index into array <code>ch</code> to begin copying
               the challenge bytes.</dd>
<dt>Returns:</dt>
<dd><code>true</code> if successful, <code>false</code> if an error
         occurred (use <code>getLastError()</code> for more information on the
         type of error)</dd>
<dt>Throws:</dt>
<dd><code><a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></code> - on a 1-Wire communication error such as reading an
                            incorrect CRC from a 1-Wire device. This could be
                            caused by a physical interruption in the 1-Wire
                            Network due to shorts or a newly arriving 1-Wire
                            device issuing a 'presence pulse'.</dd>
<dd><code><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a></code> - on a communication or setup error with the 1-Wire
                            adapter</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="SHAiButtonUser.html#readAccountData(byte%5B%5D,int,byte%5B%5D,int,byte%5B%5D,int)"><code>SHAiButtonUser.readAccountData(byte[],int,byte[],int,byte[],int)</code></a></li>
<li><a href="SHAiButtonCopr.html#getLastError()"><code>SHAiButtonCopr.getLastError()</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="verifyAuthentication(byte[],byte[],byte[],byte[],byte)">
<h3>verifyAuthentication</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">verifyAuthentication</span><wbr><span class="parameters">(byte[]&nbsp;fullBindCode,
 byte[]&nbsp;pageData,
 byte[]&nbsp;scratchpad,
 byte[]&nbsp;verify_mac,
 byte&nbsp;authCmd)</span>
                             throws <span class="exceptions"><a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a>,
<a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a></span></div>
<div class="block"><p>
 Determines if a <code>SHAiButtonUser</code> belongs to the system defined by
 this Coprocessor iButton.See the usage example in this class for initializing
 a Coprocessor iButton.
 </p>

 <p>
 The first step in user authentication is to recreate the user's unique secret
 on the coprocessor button using
 <code>bindSecretToiButton(int,byte[],byte[],int)</code>. Then the coprocessor
 signs the pageData to produce a MAC. If the MAC matches that produced by the
 user, the user belongs to the system.
 </p>

 <p>
 The TMEX formatted page with the user's account data is in the 32-byte
 parameter <code>pageData</code>. If the verification is successful, the data
 data signature must still be verified with the <code>verifySignature()</code>
 method.
 </p>

 <p>
 Failure of this method does not necessarily mean that the User iButton does
 not belong to the system. It is possible that a communication disruption here
 could cause a CRC error that would be indistinguishable from a failed
 authentication. However, repeated attempts should reveal whether it was truly
 a communication problem or a User iButton that does not belong to the system.
 </p></div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="SHAiButtonCopr.html#verifyAuthentication(byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte)">verifyAuthentication</a></code>&nbsp;in class&nbsp;<code><a href="SHAiButtonCopr.html" title="class in com.dalsemi.onewire.application.sha">SHAiButtonCopr</a></code></dd>
<dt>Parameters:</dt>
<dd><code>fullBindCode</code> - 15-byte binding code used to recreate user iButtons
                     unique secret in the coprocessor.</dd>
<dd><code>pageData</code> - 32-byte buffer containing the data page holding the
                     user's account data.</dd>
<dd><code>scratchpad</code> - the 32-byte scratchpad contents for which the signature
                     is generated. This will contain parameters such as the
                     user's write cycle counter for the page, the user's
                     1-wire address, and the page number where account data is
                     stored.</dd>
<dd><code>verify_mac</code> - the 20-byte buffer containing the user's authentication
                     response to the coprocessor's challenge.</dd>
<dt>Returns:</dt>
<dd><code>true</code> if the operation was successful and the user's MAC
         matches that generated by the coprocessor.</dd>
<dt>Throws:</dt>
<dd><code><a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></code> - on a 1-Wire communication error such as reading an
                            incorrect CRC from a 1-Wire device. This could be
                            caused by a physical interruption in the 1-Wire
                            Network due to shorts or a newly arriving 1-Wire
                            device issuing a 'presence pulse'.</dd>
<dd><code><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a></code> - on a communication or setup error with the 1-Wire
                            adapter</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#generateChallenge(int,byte%5B%5D,int)"><code>generateChallenge(int,byte[],int)</code></a></li>
<li><a href="#verifySignature(byte%5B%5D,byte%5B%5D,byte%5B%5D)"><code>verifySignature(byte[],byte[],byte[])</code></a></li>
<li><a href="#bindSecretToiButton(int,byte%5B%5D,byte%5B%5D,int)"><code>bindSecretToiButton(int,byte[],byte[],int)</code></a></li>
<li><a href="../../container/OneWireContainer18.html#SHAFunction(byte,int)"><code>OneWireContainer18.SHAFunction(byte,int)</code></a></li>
<li><a href="../../container/OneWireContainer18.html#matchScratchPad(byte%5B%5D)"><code>OneWireContainer18.matchScratchPad(byte[])</code></a></li>
<li><a href="SHAiButtonCopr.html#getLastError()"><code>SHAiButtonCopr.getLastError()</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="createDataSignatureAuth(byte[],byte[],byte[],int,byte[])">
<h3>createDataSignatureAuth</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">createDataSignatureAuth</span><wbr><span class="parameters">(byte[]&nbsp;accountData,
 byte[]&nbsp;signScratchpad,
 byte[]&nbsp;mac_buffer,
 int&nbsp;macStart,
 byte[]&nbsp;fullBindCode)</span>
                                throws <span class="exceptions"><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a>,
<a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></span></div>
<div class="block"><p>
 Creates a data signature, but instead of using the signing secret, it uses
 the authentication secret, bound for a particular button.
 </p>

 <P>
 <code>fullBindCode</code> is ignored by the Coprocessor VM. Instead of
 binding the secret to the signing page, the coprocessor VM "cheats" and lets
 you sign the workspace page, where (presumably) the secret is already bound.
 </p></div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="SHAiButtonCopr.html#createDataSignatureAuth(byte%5B%5D,byte%5B%5D,byte%5B%5D,int,byte%5B%5D)">createDataSignatureAuth</a></code>&nbsp;in class&nbsp;<code><a href="SHAiButtonCopr.html" title="class in com.dalsemi.onewire.application.sha">SHAiButtonCopr</a></code></dd>
<dt>Parameters:</dt>
<dd><code>accountData</code> - the 32-byte data page for which the signature is
                       generated.</dd>
<dd><code>signScratchpad</code> - the 32-byte scratchpad contents for which the signature
                       is generated. This will contain parameters such as the
                       user's write cycle counter for the page, the user's
                       1-wire address, and the page number where account data
                       is stored.</dd>
<dd><code>mac_buffer</code> - used to return the 20-byte signature generated by
                       signing the page using the coprocessor's system signing
                       secret.</dd>
<dd><code>macStart</code> - the offset into mac_buffer where copying should start.</dd>
<dd><code>fullBindCode</code> - ignored by simulated coprocessor</dd>
<dt>Returns:</dt>
<dd><code>true</code> if successful, <code>false</code> if an error
         occurred (use <code>getLastError()</code> for more information on the
         type of error)</dd>
<dt>Throws:</dt>
<dd><code><a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></code> - on a 1-Wire communication error such as reading an
                            incorrect CRC from a 1-Wire device. This could be
                            caused by a physical interruption in the 1-Wire
                            Network due to shorts or a newly arriving 1-Wire
                            device issuing a 'presence pulse'.</dd>
<dd><code><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a></code> - on a communication or setup error with the 1-Wire
                            adapter</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="../../container/OneWireContainer18.html#SHAFunction(byte,int)"><code>OneWireContainer18.SHAFunction(byte,int)</code></a></li>
<li><a href="#createDataSignature(byte%5B%5D,byte%5B%5D,byte%5B%5D,int)"><code>createDataSignature(byte[],byte[],byte[],int)</code></a></li>
<li><a href="SHAiButtonCopr.html#getLastError()"><code>SHAiButtonCopr.getLastError()</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="verifySignature(byte[],byte[],byte[])">
<h3>verifySignature</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">verifySignature</span><wbr><span class="parameters">(byte[]&nbsp;pageData,
 byte[]&nbsp;scratchpad,
 byte[]&nbsp;verify_mac)</span>
                        throws <span class="exceptions"><a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a>,
<a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a></span></div>
<div class="block"><P>
 Verifies a User iButton's signed data on this Coprocessor iButton. The
 Coprocessor must recreate the signature based on the data in the file and the
 contents of the given scratchpad, and then match that with the signature
 passed in verify_mac.
 </P></div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="SHAiButtonCopr.html#verifySignature(byte%5B%5D,byte%5B%5D,byte%5B%5D)">verifySignature</a></code>&nbsp;in class&nbsp;<code><a href="SHAiButtonCopr.html" title="class in com.dalsemi.onewire.application.sha">SHAiButtonCopr</a></code></dd>
<dt>Parameters:</dt>
<dd><code>pageData</code> - the full 32 byte TMEX file from the User iButton (from
                   <code>verifyAuthentication</code>) with the</dd>
<dd><code>scratchpad</code> - the 32-byte scratchpad contents for which the signature is
                   generated. This will contain parameters such as the user's
                   write cycle counter for the page, the user's 1-wire
                   address, and the page number where account data is stored.</dd>
<dd><code>verify_mac</code> - the 20-byte buffer containing the signature the user had
                   stored with the account data file.</dd>
<dt>Returns:</dt>
<dd><code>true<code> if the data file is valid, <code>false</code> if an
         error occurred (use <code>getLastError()</code> for more information
         on the type of error)</dd>
<dt>Throws:</dt>
<dd><code><a href="../../adapter/OneWireIOException.html" title="class in com.dalsemi.onewire.adapter">OneWireIOException</a></code> - on a 1-Wire communication error such as reading an
                            incorrect CRC from a 1-Wire device. This could be
                            caused by a physical interruption in the 1-Wire
                            Network due to shorts or a newly arriving 1-Wire
                            device issuing a 'presence pulse'.</dd>
<dd><code><a href="../../OneWireException.html" title="class in com.dalsemi.onewire">OneWireException</a></code> - on a communication or setup error with the 1-Wire
                            adapter</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#verifyAuthentication(byte%5B%5D,byte%5B%5D,byte%5B%5D,byte%5B%5D,byte)"><code>verifyAuthentication(byte[],byte[],byte[],byte[],byte)</code></a></li>
<li><a href="SHAiButtonCopr.html#getLastError()"><code>SHAiButtonCopr.getLastError()</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="bindSecretToiButton(int,byte[],byte[],int)">
<h3>bindSecretToiButton</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">bindSecretToiButton</span><wbr><span class="parameters">(int&nbsp;pageNum,
 byte[]&nbsp;bindData,
 byte[]&nbsp;bindCode,
 int&nbsp;secretNum)</span></div>
<div class="block"><p>
 Binds an installed secret to this virtual DS1963S by using well-known binding
 data and this DS1963S's (unique?) address. This makes the secret unique for
 this iButton. Coprocessor iButtons use this method to recreate the iButton's
 secret to verify authentication. Roving iButtons use this method to finalize
 their secret keys.
 </p>

 <p>
 Note that unlike in the <code>installMasterSecret()</code> method, the page
 number does not need to be equivalent to the <code>secret_number</code>
 modulo 8. The new secret (installed secret + binding code) is generated from
 this page but can be copied into another secret. User iButtons should bind to
 the same page the secret was installed on. Coprocessor iButtons must copy to
 a new secret to preserve the general system authentication secret.
 </p>

 <p>
 The binding should be either 7 bytes long or 15 bytes long. A 15-length
 <code>byte</code> array is unaltered and placed in the scratchpad for the
 binding. A 7-length <code>byte</code> array is combined with the page number
 and DS1963S unique address and then placed in the scratchpad. Coprocessors
 should use a pre-formatted 15-length <code>byte</code> array. User iButtons
 should let the method format for them (i.e. use the 7-length
 <code>byte</code> array option).
 </p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>page</code> - the page number that has the master secret already
                      installed</dd>
<dd><code>bind_data</code> - 32 bytes of binding data used to bind the iButton to the
                      system</dd>
<dd><code>bind_code</code> - the 7-byte or 15-byte binding code</dd>
<dd><code>secret_number</code> - secret number to copy the resulting secret to</dd>
<dt>Returns:</dt>
<dd><code>true</code> if successful</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#installMasterSecret(int,byte%5B%5D,int)"><code>installMasterSecret(int,byte[],int)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="installMasterSecret(int,byte[],int)">
<h3>installMasterSecret</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">installMasterSecret</span><wbr><span class="parameters">(int&nbsp;pageNum,
 byte[]&nbsp;secret,
 int&nbsp;secretNum)</span></div>
<div class="block"><p>
 Installs a secret on this virtual DS1963S. The secret is written in partial
 phrases of 47 bytes (32 bytes to a memory page, 15 bytes to the scratchpad)
 and is cumulative until the entire secret is processed. Secrets are
 associated with a page number. See the datasheet for more information on this
 association.
 </p>

 <p>
 In most cases, <code>page</code> should be equal to
 <code>secret_number</code> or <code>secret_number+8</code>, based on the
 association of secrets and page numbers. A secret is 8 bytes and there are 8
 secrets. These 8 secrets are associated with the first 16 pages of memory.
 </p>

 <p>
 On TINI, this method will be slightly faster if the secret's length is
 divisible by 47. However, since secret key generation is a part of
 initialization, it is probably not necessary.
 </p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>secret</code> - the entire secret to be installed</dd>
<dd><code>page</code> - the page number used to write the partial secrets to</dd>
<dd><code>secret_number</code> - the secret 'page' to use (0 - 7)</dd>
<dt>Returns:</dt>
<dd><code>true</code> if successful</dd>
<dt>See Also:</dt>
<dd>
<ul class="tag-list-long">
<li><a href="#bindSecretToiButton(int,byte%5B%5D,byte%5B%5D,int)"><code>bindSecretToiButton(int,byte[],byte[],int)</code></a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="toString()">
<h3>toString</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">toString</span>()</div>
<div class="block">Returns a string representing the 1-Wire address of this SHAiButton.</div>
<dl class="notes">
<dt>Overrides:</dt>
<dd><code><a href="SHAiButtonCopr.html#toString()">toString</a></code>&nbsp;in class&nbsp;<code><a href="SHAiButtonCopr.html" title="class in com.dalsemi.onewire.application.sha">SHAiButtonCopr</a></code></dd>
<dt>Returns:</dt>
<dd>a string containing the 8-byte address of this 1-Wire device.</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
